#!/usr/bin/env python
from repo_scraper.FolderChecker import FolderChecker
import sys
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("folder", help="the folder you want to check", type=str)
parser.add_argument("-i", "--ignore", help="optional ignore file", type=str)
args = parser.parse_args()

#Options:
#Which alerts to print
folder_path = args.folder
ignore_path = args.ignore

#results_to_print = ['ALERT', 'WARNING', 'NOTHING']
results_to_print = ['ALERT']

print 'Checking folder %s...' % folder_path
if ignore_path:
    print 'Using ignore file %s' % ignore_path

#Create an instance of folder checker,
#this class will list files in all subdirectories,
#then apply ignore file rules. It provides a generator
#to check each file
fc = FolderChecker(folder_path, ignore_path)

#Get the generator to traverse the folder structure
file_traverser = fc.file_traverser()

for result in file_traverser:
    if result.result_type in results_to_print:
        print f
        print '\t\t%s\n' % r.matches